# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á Stock ‡∏à‡∏≤‡∏Å Zortout

## üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á Stock

### 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

#### ‡∏Å. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Marketplace Account
- ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Marketplace** > **Accounts** > **Zortout**
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤:
  - ‚úÖ **Sync Enabled** ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
  - ‚úÖ **Store Name**, **API Key**, **API Secret** ‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß
  - ‚úÖ **Stock Location** ‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ sync ‡∏à‡∏≤‡∏Å warehouse ‡πÄ‡∏â‡∏û‡∏≤‡∏∞)

#### ‡∏Ç. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Products
- ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Inventory** > **Products**
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤:
  - ‚úÖ Products ‡∏°‡∏µ **SKU** (default_code) ‡πÅ‡∏•‡πâ‡∏ß
  - ‚úÖ **Track Inventory?** checkbox ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á "By Quantity"
  - ‚úÖ **is_storable=True** (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ checkbox ‡πÅ‡∏™‡∏î‡∏á)

### 2. ‡∏î‡∏∂‡∏á Stock ‡∏à‡∏≤‡∏Å Zortout

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° "‡∏î‡∏∂‡∏á‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Marketplace** > **Accounts** > **Zortout**
2. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **"‡∏î‡∏∂‡∏á‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"** (Pull Stock)
3. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞:
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á Job ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö sync stock
   - ‡∏î‡∏∂‡∏á stock ‡∏à‡∏≤‡∏Å Zortout ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö products ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
   - ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó stock ‡πÉ‡∏ô Odoo

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÉ‡∏ä‡πâ Job Queue

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Marketplace** > **Jobs**
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **New**
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
   - **Name**: `Sync Stock from Zortout`
   - **Job Type**: `Sync Stock from Zortout`
   - **Account**: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Zortout account
   - **Payload**:
     ```json
     {
       "warehouse_code": "ODS001",  // Optional: Warehouse code (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏∞ sync ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å warehouse)
       "sku_list": []  // Optional: SKU list (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏∞ sync ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
     }
     ```
   - **State**: `Pending`
   - **Next Run At**: ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
4. ‡∏Ñ‡∏•‡∏¥‡∏Å **Save**
5. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **"Run Now"** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ô job ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

### 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

#### ‡∏Å. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Job Status

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Marketplace** > **Jobs**
2. ‡πÄ‡∏õ‡∏¥‡∏î Job ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
   - **State**: ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô `Done` (‡∏ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à) ‡∏´‡∏£‡∏∑‡∏≠ `Failed` (‡∏ñ‡πâ‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß)
   - **Result**: ‡∏î‡∏π‡∏à‡∏≥‡∏ô‡∏ß‡∏ô products ‡∏ó‡∏µ‡πà sync ‡πÅ‡∏•‡∏∞ stock ‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó
   - **Error**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ error ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

#### ‡∏Ç. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Stock ‡πÉ‡∏ô Products

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Inventory** > **Products**
2. ‡πÄ‡∏õ‡∏¥‡∏î product ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
   - **Quantity On Hand**: ‡∏Ñ‡∏ß‡∏£‡πÅ‡∏™‡∏î‡∏á stock ‡∏à‡∏≤‡∏Å Zortout
   - **Track Inventory?**: ‡∏Ñ‡∏ß‡∏£‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á "By Quantity"

#### ‡∏Ñ. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Stock Quant

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Inventory** > **Operations** > **Inventory**
2. ‡πÉ‡∏ä‡πâ filter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ product ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ stock quantity ‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏•‡πâ‡∏ß

### 4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Logs

#### ‡πÉ‡∏ä‡πâ Script ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Monitor Logs

```bash
# Monitor stock sync logs
cd /Users/nattaphonsupa/odoo19
./addons/otd_marketplace_stock/monitor_stock_sync.sh
```

‡∏´‡∏£‡∏∑‡∏≠

```bash
# Monitor detailed stock sync logs
./addons/otd_marketplace_stock/monitor_stock_sync_detailed.sh
```

## üîç Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Stock ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ:**
1. Product ‡πÑ‡∏°‡πà‡∏°‡∏µ SKU (default_code)
2. Product type ‡πÄ‡∏õ‡πá‡∏ô 'service' (‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ track stock)
3. Warehouse code ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
4. API credentials ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ product ‡∏°‡∏µ SKU ‡πÅ‡∏•‡∏∞ type='consu' (Goods)
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Track Inventory checkbox ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö warehouse code ‡πÉ‡∏ô Zortout
4. ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° "‡∏ó‡∏î‡∏™‡∏≠‡∏ö Warehouse Code" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Job Failed

**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
1. ‡∏î‡∏π Error message ‡πÉ‡∏ô Job result
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logs ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API credentials
4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö network connection

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Stock = 0 ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ:**
1. Warehouse code ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
2. Products ‡πÉ‡∏ô Zortout ‡πÑ‡∏°‡πà‡∏°‡∏µ stock
3. API ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á warehouse ‡πÑ‡∏î‡πâ

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡∏•‡∏≠‡∏á sync ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏ warehouse_code (sync ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å warehouse)
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö stock ‡πÉ‡∏ô Zortout ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
3. ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° "‡∏î‡∏π Warehouse List" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π warehouse ‡∏ó‡∏µ‡πà‡∏°‡∏µ

## üìä Stock Sync Logic

### ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Stock

1. **Fetch Products from Zortout**
   - ‡∏î‡∏∂‡∏á products ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≤‡∏° SKU list)
   - ‡∏î‡∏∂‡∏á `availablestock` ‡∏à‡∏≤‡∏Å Zortout

2. **Update Stock in Odoo**
   - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ product ‡πÉ‡∏ô Odoo ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ SKU
   - ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó `stock.quant` ‡∏î‡πâ‡∏ß‡∏¢ `inventory_quantity`
   - ‡πÉ‡∏ä‡πâ location ‡∏à‡∏≤‡∏Å `stock_location_id` ‡∏´‡∏£‡∏∑‡∏≠ warehouse

3. **Skip Products**
   - Products ‡∏ó‡∏µ‡πà type='service' ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å skip
   - Products ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ SKU ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å skip

## üí° Tips

1. **Sync ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å Warehouse**: ‡∏ï‡∏±‡πâ‡∏á Stock Location ‡πÄ‡∏õ‡πá‡∏ô empty ‡πÄ‡∏û‡∏∑‡πà‡∏≠ sync ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å warehouse
2. **Sync ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Warehouse**: ‡∏ï‡∏±‡πâ‡∏á Stock Location ‡∏ó‡∏µ‡πà‡∏°‡∏µ warehouse_id ‡πÅ‡∏•‡∏∞ warehouse code ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Zortout
3. **Sync ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ SKU**: ‡∏£‡∏∞‡∏ö‡∏∏ SKU list ‡πÉ‡∏ô payload ‡πÄ‡∏û‡∏∑‡πà‡∏≠ sync ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ products ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
4. **Monitor Logs**: ‡πÉ‡∏ä‡πâ script ‡πÄ‡∏û‡∏∑‡πà‡∏≠ monitor logs ‡πÅ‡∏ö‡∏ö real-time

## üîÑ Realtime Sync

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö realtime sync (sync ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å X ‡∏ô‡∏≤‡∏ó‡∏µ):

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Settings** > **Technical** > **Automation** > **Scheduled Actions**
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Scheduled Action ‡πÉ‡∏´‡∏°‡πà
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `action_sync_stock_from_zortout` ‡∏ó‡∏∏‡∏Å X ‡∏ô‡∏≤‡∏ó‡∏µ

‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ **Pull Interval** ‡πÉ‡∏ô Marketplace Account (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)

