# üîß ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Dashboard ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô Multi-Company

## ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö

- **‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î**: Dashboard ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
- **My Company (Chicago)**: Dashboard ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•

---

## üîç ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏

1. **Patch ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ filter ‡∏ï‡∏≤‡∏° company**
   - `sales_orders = self.env['sale.order'].search([])` ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å company
   - ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ filter ‡∏ï‡∏≤‡∏° `company_id` ‡∏Ç‡∏≠‡∏á company ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

2. **Multi-company context**
   - Dashboard ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° company ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
   - ‡πÅ‡∏ï‡πà patch ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å company

3. **Company-specific data**
   - Sales orders ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ company ‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô
   - ‡∏ï‡πâ‡∏≠‡∏á filter ‡∏ï‡∏≤‡∏° `company_id`

---

## ‚úÖ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. ‡πÄ‡∏û‡∏¥‡πà‡∏° Company Filter

```python
# ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
sales_orders = self.env['sale.order'].search([])

# ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
current_company = self.env.company
sales_orders = self.env['sale.order'].search([
    ('company_id', '=', current_company.id)
])
```

### 2. ‡πÄ‡∏û‡∏¥‡πà‡∏° Logging

```python
_logger.info(f"Fetching sales data for company: {current_company.name} (id={current_company.id})")
_logger.info(f"Sales data for {current_company.name}: {total_orders} orders, {total_amount} total")
```

### 3. ‡πÄ‡∏û‡∏¥‡πà‡∏° Company Name ‡πÉ‡∏ô Data

```python
sales_data = {
    'total_orders': total_orders,
    'total_amount': total_amount,
    'currency_symbol': default_currency.get('symbol', '‡∏ø'),
    'company_name': current_company.name  # ‡πÄ‡∏û‡∏¥‡πà‡∏° company name
}
```

---

## üìã ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

`custom_theme_onthisday/models/spreadsheet_dashboard_patch.py`

**‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á:**
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£ filter sales orders ‡∏ï‡∏≤‡∏° `company_id`
- ‡πÉ‡∏ä‡πâ `self.env.company` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á company ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
- ‡πÄ‡∏û‡∏¥‡πà‡∏° logging ‡πÄ‡∏û‡∏∑‡πà‡∏≠ debug

---

## üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ Deploy

### 1. Restart Odoo

```bash
sudo systemctl restart odoo
```

### 2. Clear Browser Cache

- ‡∏Å‡∏î `Ctrl+Shift+R` (Windows/Linux)
- ‡∏´‡∏£‡∏∑‡∏≠ `Cmd+Shift+R` (Mac)

### 3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Dashboard

#### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô "My Company (Chicago)"
1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô company ‡πÄ‡∏õ‡πá‡∏ô "My Company (Chicago)"
2. ‡πÄ‡∏õ‡∏¥‡∏î Dashboard
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

#### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î"
1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô company ‡πÄ‡∏õ‡πá‡∏ô "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î"
2. ‡πÄ‡∏õ‡∏¥‡∏î Dashboard
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

## üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Logs

```bash
# ‡∏î‡∏π logs ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ patch ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
sudo tail -f /var/log/odoo/odoo-server.log | grep -i "sales data\|dashboard\|company"
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:**
```
INFO: Fetching sales data for company: ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î (id=1)
INFO: Sales data for ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î: 384 orders, 791915.92 total
```

---

## üìä ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á

### ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- ‚ùå "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î": Dashboard ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
- ‚úÖ "My Company (Chicago)": Dashboard ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•

### ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- ‚úÖ "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î": Dashboard ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á company ‡∏ô‡∏µ‡πâ)
- ‚úÖ "My Company (Chicago)": Dashboard ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á company ‡∏ô‡∏µ‡πâ)

---

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á

### 1. Company Context

- Patch ‡πÉ‡∏ä‡πâ `self.env.company` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á company ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
- ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ company context ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

### 2. Sales Orders Filter

- Filter ‡∏ï‡∏≤‡∏° `company_id` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞ company
- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ sales orders ‡πÉ‡∏ô company ‡∏ô‡∏±‡πâ‡∏ô ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á 0

### 3. Multi-Company Setup

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ multi-company ‡∏ñ‡∏π‡∏Å configure ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ user ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á company ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

---

## üîß Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Dashboard ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô company ‡∏´‡∏ô‡∏∂‡πà‡∏á

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logs:
   ```bash
   sudo tail -f /var/log/odoo/odoo-server.log | grep -i "sales data"
   ```

2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ company ‡∏°‡∏µ sales orders ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà:
   ```bash
   sudo -u odoo psql -d odoo16 -c "
   SELECT company_id, COUNT(*) as order_count
   FROM sale_order
   GROUP BY company_id;
   "
   ```

3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ user ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á company ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Dashboard ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î company

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ company context ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logs ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤ patch ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å company ‡πÑ‡∏´‡∏ô
3. Clear browser cache ‡πÅ‡∏•‡∏∞ login ‡πÉ‡∏´‡∏°‡πà

---

## üìù Checklist

- [ ] Restart Odoo
- [ ] Clear browser cache
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Dashboard ‡πÉ‡∏ô "My Company (Chicago)"
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Dashboard ‡πÉ‡∏ô "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î"
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logs ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤ patch ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏° company

---

## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤**: Dashboard ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏≠‡∏ô ‡∏î‡∏µ‡∏™ ‡πÄ‡∏î‡∏¢‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î" ‡πÅ‡∏ï‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô "My Company (Chicago)"

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: Patch ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ filter sales orders ‡∏ï‡∏≤‡∏° company context

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£ filter sales orders ‡∏ï‡∏≤‡∏° `company_id` ‡∏Ç‡∏≠‡∏á company ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**: Dashboard ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å company ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° company ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å

