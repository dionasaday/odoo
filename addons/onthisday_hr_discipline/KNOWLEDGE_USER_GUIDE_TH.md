# คู่มือการใช้งานระบบวินัยและมาตรฐานการทำงาน (onthisday_hr_discipline)

เอกสารนี้สำหรับนำไปลงในระบบ Knowledge เพื่ออธิบายการใช้งานหลักของโมดูลวินัยและมาตรฐานการทำงาน

## กลุ่มผู้ใช้งานและสิทธิ์
- พนักงานทั่วไป (Discipline User): ดูข้อมูลของตนเองเท่านั้น
- หัวหน้า/ผู้จัดการ (Discipline Manager): ดูและยืนยันเคสของทีมภายใต้การดูแล
- HR (Discipline HR): จัดการเคส/บทลงโทษ/เลดเจอร์ทั้งหมดในบริษัท

## เมนูหลัก
ตำแหน่ง: Employees > วินัยและมาตรฐานการทำงาน

### เมนูสำหรับพนักงาน
- วินัยของฉัน
  - Token Balance ของฉัน
  - สรุปคะแนนของฉัน (รายกรณีความผิด)

### เมนูสำหรับหัวหน้า/HR
- สมุดคะแนน (Ledger)
- กรณีความผิด (Discipline Case)
- สรุปการมาสายรายเดือน
- Attendance Awards

### Configuration (สำหรับ HR/Manager)
- ประเภทความผิด
- รายการความผิด (Catalog)
- เกณฑ์บทลงโทษ
- กฎการมาสาย (Attendance)

## การใช้งานสำหรับพนักงาน
### 1) ดู Token Balance ของฉัน
เส้นทาง: วินัยของฉัน > Token Balance ของฉัน  
ใช้ดูคะแนนคงเหลือของงวดปัจจุบัน และรายละเอียดการหัก Token ในงวดนั้น

### 2) ดูสรุปคะแนนของฉัน
เส้นทาง: วินัยของฉัน > สรุปคะแนนของฉัน (รายกรณีความผิด)  
ระบบแยกสรุปตามประเภทความผิด เพื่อให้เห็นภาพรวมการถูกหักคะแนน

## การใช้งานสำหรับหัวหน้า/ผู้จัดการ
### 1) ตรวจและยืนยันเคส
เส้นทาง: กรณีความผิด  
ปุ่มหลัก:
- ยืนยันและหักคะแนน: ยืนยันเคสและบันทึกคะแนนทันที
- สรุปบทลงโทษ: เปิดหน้าต่างเลือกบทลงโทษและบันทึกผล

หากเคสต้องยืนยันพิเศษ (เช่น แจ้งล่วงหน้า + สายเกินเกณฑ์) ระบบจะแสดงหน้าต่างยืนยันผลก่อนดำเนินการ

### 2) ดูเลดเจอร์คะแนน
เส้นทาง: สมุดคะแนน  
ใช้ตรวจสอบการหักคะแนนทั้งหมดของทีมที่ดูแล

## การใช้งานสำหรับ HR
### 1) ตรวจสอบและแก้ไขย้อนหลัง
HR สามารถแก้ไขข้อมูลเคส, เปลี่ยนสถานะ, หรือแก้ไขการแจ้งล่วงหน้าได้  
เมื่อแก้ไขข้อมูลสำคัญ ระบบจะคำนวณเลดเจอร์ใหม่เพื่อคงความถูกต้อง

### 2) สรุปบทลงโทษและส่งอีเมล
เมื่อสรุปบทลงโทษ ระบบสามารถส่งอีเมลผลการบันทึกบทลงโทษให้พนักงานได้ (ตั้งค่าได้ตามระดับบทลงโทษ)

## กติกาการคำนวณมาสาย (Policy 002/2025)
- หนึ่งเคสต่อวัน: ใช้การเช็คอินครั้งแรกของวันนั้นเท่านั้น
- ไม่มีตารางงาน/ไม่มีช่วงเวลาทำงาน: จะไม่สร้างเคส
- เช็คอินนอกเวลางาน: ไม่สร้างเคส แต่มีการแจ้งเตือน
- วันลา/วันหยุด: ไม่สร้างเคส
- Grace Minutes (Late): ถ้าสายไม่เกินจำนวนนี้ จะไม่ถูกนับเป็นการมาสาย

### การหัก Token
- สาย ≤ Tier 1 Max Minutes → หัก Token ตาม Tier 1
- สาย > Tier 1 Max Minutes + แจ้งล่วงหน้า → หัก Token ตาม Tier 2 (ต้องยืนยัน)
- สาย > Tier 1 Max Minutes + ไม่แจ้งล่วงหน้า → หัก Token ตาม No Notice

## การตั้งค่าหลัก (Settings > Companies)
### Discipline
- Discipline Start Date: วันที่เริ่มนับเคส

### Attendance & Discipline (Legacy)
- Grace Minutes (Late): จำนวน “นาทีผ่อนผัน” ที่ยังไม่นับสาย
- Alert when late over (min): นาทีที่เริ่มเตือนว่า “สายเกินเกณฑ์”
- Alert every N occurrences: จำนวนครั้งที่สายสะสมก่อนแจ้งเตือน

### Token-based Lateness Policy 002/2025
- Tier 1 Max Minutes
- Tokens for Tier 1 (≤10 min)
- Tokens for Tier 2 (>10 min)
- Tokens for No Notice
- Token Period Type (เช่น Monthly)
- Monthly Reset Day
- Management Review Threshold
- Starting Tokens per Period

## คำถามที่พบบ่อย (FAQ)
**Q: สาย 2–3 นาทีแล้วไม่โดนหัก?**  
A: ตรวจค่า Grace Minutes (Late) หากตั้งไว้มากกว่า 0 ระบบจะไม่นับเป็นการมาสาย

**Q: ไม่เห็นเคสของวันนี้?**  
A: ตรวจว่าเป็นการเช็คอินครั้งแรกของวันนั้นหรือไม่ และมีตารางเวลาทำงานครบถ้วนหรือไม่

**Q: ไม่เห็นเมนูวินัย?**  
A: ตรวจสิทธิ์ในกลุ่ม Discipline User/Manager/HR

**Q: Token Balance เป็น 0 ทั้งที่ตั้ง Starting Tokens แล้ว?**  
A: ตรวจว่ามีการอัปเกรดโมดูลล่าสุด และตรวจว่าเลดเจอร์เริ่มต้นถูกสร้างในงวดหรือไม่

## หมายเหตุด้านความปลอดภัย
พนักงานเห็นเฉพาะข้อมูลของตนเอง  
หัวหน้าเห็นเฉพาะทีมภายใต้การดูแล  
HR เห็นและจัดการข้อมูลทั้งหมดในบริษัท
