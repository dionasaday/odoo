<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data noupdate="1">

    <record id="mail_template_monthly_summary" model="mail.template">
      <field name="name">Discipline: Monthly Summary to Manager</field>
      <field name="model_id" ref="base.model_res_company"/>
      <field name="subject">[สรุปคะแนนความประพฤติ] {{ctx.get('manager') and ctx.get('manager').name or ''}} — {{format_date(ctx.get('period_from'))}} ถึง {{format_date(ctx.get('period_to'))}}</field>
      <field name="body_html" type="xml">
        <div>
          <p>
            เรียน <t t-esc="(ctx.get('manager') and ctx.get('manager').name) or 'ผู้จัดการ'"/>,
          </p>

          <p>
            สรุปคะแนนความประพฤติประจำเดือน
            <b><t t-esc="format_date(ctx.get('period_from'))"/></b> ถึง
            <b><t t-esc="format_date(ctx.get('period_to'))"/></b>
            (มาสายคิดเมื่อ <t t-esc="ctx.get('min_min') or 10"/> นาทีขึ้นไป)
          </p>

          <t t-set="rows" t-value="ctx.get('summary_rows') or []"/>
          <table border="1" cellpadding="6" cellspacing="0" style="border-collapse:collapse; width:100%;">
            <thead style="background:#f3f3f3;">
              <tr>
                <th style="text-align:left;">พนักงาน</th>
                <th style="text-align:right;">คะแนนที่ได้รับ</th>
                <th style="text-align:right;">มาสาย (วัน)</th>
                <th style="text-align:right;">นาทีสายรวม</th>
              </tr>
            </thead>
            <tbody>
              <t t-foreach="rows" t-as="r" t-key="r['emp'].id">
                <tr>
                  <td><t t-esc="r['emp'].name"/></td>
                  <td style="text-align:right;"><t t-esc="r.get('points', 0)"/></td>
                  <td style="text-align:right;"><t t-esc="r.get('late_days', 0)"/></td>
                  <td style="text-align:right;"><t t-esc="r.get('late_minutes', 0)"/></td>
                </tr>
              </t>
              <t t-if="not rows">
                <tr><td colspan="4">ไม่พบข้อมูลในช่วงเวลานี้</td></tr>
              </t>
            </tbody>
          </table>

          <p style="margin-top:12px;">
            อีเมลนี้สร้างโดยระบบอัตโนมัติของบริษัท <t t-esc="object.name or ''"/>.
          </p>
        </div>
      </field>
      <field name="auto_delete" eval="True"/>
    </record>

  </data>
</odoo>
